# TFMD: Time-Frequency Mode Decomposition

This repository contains the MATLAB implementation for the **Time-Frequency Mode Decomposition (TFMD)** method.

## Introduction

TFMD is a signal processing technique designed to decompose a non-stationary signal into its constituent oscillatory modes. The method operates by identifying and isolating high-energy regions in the signal's time-frequency representation, which is obtained using the Short-Time Fourier Transform (STFT).

## Methodology Flowchart

The core of the TFMD methodology is illustrated in the flowchart below. This process systematically identifies, separates, and reconstructs the intrinsic modes of a signal from its time-frequency plane.

![Flowchart of the proposed TFMD methodology](figures/Flowchart.png)

*Figure 1: Flowchart of the proposed TFMD methodology. The process starts with (a) the input signal $x[n]$, which is transformed by the STFT to yield (b) the complex coefficients $S[k,m]$ and their corresponding spectrogram $|S[k,m]|$. The (c) non-negative frequency portion of the spectrogram is then (d) smoothed to produce a smoothed spectrogram $\hat{S}[k',m]$, which highlights high-energy TF regions. (e) An initial binary mask $B_{\text{ini}}[k',m]$ is generated via adaptive thresholding. (f) Connected-component labeling (CCL) is applied to identify distinct regions of connected 1-valued pixels, assigning a unique label to each region in the labeled components $L[k',m]$. (g) These regions are isolated as candidate masks $B_{\text{cand}, i}[k',m]$. These masks are then (h) filtered by size to remove masks that may be generated by noise artifacts, yielding a set of filtered masks $B_{\text{filt}, i}[k',m]$. (i) The filtered masks are extended with frequency symmetry to create the final masks $B_{i}[k,m]$. These are used to (j) extract the masked TF component for each mode from the original STFT coefficients. (k) Finally, ISTFT reconstructs each masked TF component into a time-domain mode, and (l) these modes are summed to synthesize the final reconstructed signal $\hat{x}[n]$.*

## File Structure

-   `tfmd.m`: The core function that implements the Time-Frequency Mode Decomposition algorithm.
-   `test.m`: An example script demonstrating how to use the `tfmd.m` function and visualize the results.
-   `generate_signal.m`: A script to generate a sample signal for testing purposes.
-   `Flowchart.pdf`: The source PDF file containing the detailed methodology flowchart.

## How to Use

To run a demonstration of the TFMD algorithm, simply execute the `test.m` script in MATLAB.

```matlab
% Run the complete test script
test;

% --- Or, call the functions step-by-step ---

% 1. Generate a sample signal
input_signal = generate_signal();

% 2. Decompose the signal using TFMD
modes = tfmd(input_signal);

% 3. Analyze or visualize the resulting modes
% ... your code here ...
```

## Requirements

-   **MATLAB**
-   **Signal Processing Toolbox™**: Required for `stft` and `istft` functions.
-   **Image Processing Toolbox™**: Required for connected-component labeling functions like `bwlabel` or `bwconncomp`.

## Contributing

Contributions are welcome! Please feel free to submit a pull request or open an issue.

## License

Consider adding an open-source license to your project by creating a `LICENSE` file.
